Import('*')
import os

target = ['#drive/output/derived/data_export/df_pr.parquet']
source = ['#source/derived/data_export/data_export.py']

for file in os.listdir('../../../drive/output/scrape/extract_github_data/pull_request_data/*.csv'):
    source.append(f'#drive/output/scrape/extract_github_data/pull_request_data/{file}')
for file in os.listdir('../../../drive/output/scrape/extract_github_data/pull_request_review_data/*.csv'):
    source.append(f'#drive/output/scrape/extract_github_data/pull_request_review_data/{file}')
for file in os.listdir('../../../drive/output/scrape/extract_github_data/pull_request_review_comment_data/*.csv'):
    source.append(f'#drive/output/scrape/extract_github_data/pull_request_review_comment_data/{file}')

env.Python(target, source)


target = ['#drive/output/derived/data_export/df_issue.parquet']
source = ['#source/derived/data_export/data_export.py']

for file in os.listdir('../../../drive/output/scrape/extract_github_data/issue_data/*.csv'):
    source.append(f'#drive/output/scrape/extract_github_data/issue_data/{file}')
for file in os.listdir('../../../drive/output/scrape/extract_github_data/issue_comment_data/*.csv'):
    source.append(f'#drive/output/scrape/extract_github_data/issue_comment_data/{file}')

env.Python(target, source)


target = ['#drive/output/derived/data_export/df_pr_commits.parquet']
source = ['#source/derived/data_export/data_export.py']

for file in os.listdir('../../../drive/output/scrape/collect_commits/pr/*'):
    source.append(f'#drive/output/scrape/collect_commits/pr/{file}')

env.Python(target, source)


target = ['#drive/output/derived/data_export/df_push_commits.parquet']
source = ['#source/derived/data_export/data_export.py']

for file in os.listdir('../../../drive/output/scrape/collect_commits/push/*'):
    source.append(f'#drive/output/scrape/extract_github_data/issue_comment_data/{file}')

env.Python(target, source)
